{
  "taskId": "BF-001",
  "title": "Refine Automatic Group Creation to Timed/Untimed Choice",
  "taskType": "update",
  "updateType": "feature",
  "featureStage": "existing",
  "scope": { "frontend": true, "backend": true },
  "priority": "P1",
  "status": "draft",
  "description": "Modify product creation so vendors choose if the initial auto-created group is timed or untimed, instead of always creating both. Untimed is default.",
  "acceptanceCriteria": [
    "ProductListingForm UI displays 'Create Initial Timed Group' toggle instead of 'Enable Automatic Group Creation'.",
    "If 'Create Initial Timed Group' is OFF, submitting the form creates the product and one UNTIMED group using the specified Group Size.",
    "If 'Create Initial Timed Group' is ON, submitting the form creates the product and one TIMED group using Group Size and Countdown (seconds).",
    "Countdown input is only visible if 'Create Initial Timed Group' is ON.",
    "Group Size input is always visible and required.",
    "Backend `createProduct` function correctly calls `createGroup` with `expires_at` set for timed groups and `null` for untimed groups.",
    "Backend `createProduct` uses product's price for group's `escrow_amount` and product's `vendor_id` for group's `created_by_user_id`.",
    "Unit tests for `createProduct` verify group creation logic.",
    "Frontend tests for `ProductListingForm` verify new UI and submission logic."
  ],
  "nonFunctional": {},
  "edgeCases": [
    "Product creation succeeds, but initial group creation fails (error should be logged, product still exists).",
    "User provides non-numeric or negative value for Countdown seconds when Timed Group is selected (form validation should catch this).",
    "User provides non-numeric or non-positive value for Group Size (form validation should catch this)."
  ],
  "dependencies": [
    "Confirmation of `groups.escrow_amount` source (assumed product.price).",
    "Existing `createGroup` function in `lib/supabase/groups.ts`."
  ],
  "deliverables": [
    "src/components/products/ProductListingForm.tsx",
    "src/lib/supabase/products.ts",
    "src/components/products/AddProductModal.tsx",
    "Unit tests for src/lib/supabase/products.ts",
    "Component tests for src/components/products/ProductListingForm.tsx",
    "milestones.md",
    "subagents_report/accountable.md",
    "subagents_report/responsible.md",
    "subagents_report/consulted.md",
    "subagents_report/informed.md",
    "subagents_report/unit.md"
  ],
  "estimate": "3 story points",
  "version": "1.0.0",
  "changelog": ["Initial task definition"],
  "milestone": "MILESTONE-2",
  "raci": {
    "accountable": "agent-A-BF001",
    "responsible": "agent-R-BF001",
    "consulted": "agent-C-BF001",
    "informed": "agent-I-BF001"
  },
  "testMatrix": {
    "unit": true,
    "integration": false,
    "e2e": false
  },
  "docsMatrix": {
    "dependencyGraph": false,
    "architectureDiagram": false,
    "dbSchemaBackup": false
  },
  "created": "2023-10-27T10:00:00Z",
  "due": "2023-11-03T23:00:00Z"
}
